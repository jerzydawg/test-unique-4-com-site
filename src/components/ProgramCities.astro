---
import { getDomain, getDesignDNA } from '../lib/site-config';
import { getBrowseCitiesText } from '../lib/microcopy-variations';

export interface Props {
  program: 'lifeline' | 'acp' | 'both';
  currentState?: string;
  currentCity?: string;
}

const { program, currentState, currentCity } = Astro.props;
const domain = getDomain();
const designDNA = getDesignDNA();
const browseCitiesText = getBrowseCitiesText(domain);

// Define major cities with program availability
const programCities = {
  lifeline: [
    { name: 'New York', state: 'NY', population: '8.8M', programs: ['Lifeline', 'ACP'] },
    { name: 'Los Angeles', state: 'CA', population: '4M', programs: ['Lifeline', 'ACP'] },
    { name: 'Chicago', state: 'IL', population: '2.7M', programs: ['Lifeline', 'ACP'] },
    { name: 'Houston', state: 'TX', population: '2.3M', programs: ['Lifeline', 'ACP'] },
    { name: 'Phoenix', state: 'AZ', population: '1.6M', programs: ['Lifeline', 'ACP'] },
    { name: 'Philadelphia', state: 'PA', population: '1.6M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Antonio', state: 'TX', population: '1.5M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Diego', state: 'CA', population: '1.4M', programs: ['Lifeline', 'ACP'] },
    { name: 'Dallas', state: 'TX', population: '1.3M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Jose', state: 'CA', population: '1M', programs: ['Lifeline', 'ACP'] },
    { name: 'Austin', state: 'TX', population: '978K', programs: ['Lifeline', 'ACP'] },
    { name: 'Jacksonville', state: 'FL', population: '949K', programs: ['Lifeline', 'ACP'] }
  ],
  acp: [
    { name: 'New York', state: 'NY', population: '8.8M', programs: ['Lifeline', 'ACP'] },
    { name: 'Los Angeles', state: 'CA', population: '4M', programs: ['Lifeline', 'ACP'] },
    { name: 'Chicago', state: 'IL', population: '2.7M', programs: ['Lifeline', 'ACP'] },
    { name: 'Houston', state: 'TX', population: '2.3M', programs: ['Lifeline', 'ACP'] },
    { name: 'Phoenix', state: 'AZ', population: '1.6M', programs: ['Lifeline', 'ACP'] },
    { name: 'Philadelphia', state: 'PA', population: '1.6M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Antonio', state: 'TX', population: '1.5M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Diego', state: 'CA', population: '1.4M', programs: ['Lifeline', 'ACP'] },
    { name: 'Dallas', state: 'TX', population: '1.3M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Jose', state: 'CA', population: '1M', programs: ['Lifeline', 'ACP'] },
    { name: 'Austin', state: 'TX', population: '978K', programs: ['Lifeline', 'ACP'] },
    { name: 'Jacksonville', state: 'FL', population: '949K', programs: ['Lifeline', 'ACP'] }
  ],
  both: [
    { name: 'New York', state: 'NY', population: '8.8M', programs: ['Lifeline', 'ACP'] },
    { name: 'Los Angeles', state: 'CA', population: '4M', programs: ['Lifeline', 'ACP'] },
    { name: 'Chicago', state: 'IL', population: '2.7M', programs: ['Lifeline', 'ACP'] },
    { name: 'Houston', state: 'TX', population: '2.3M', programs: ['Lifeline', 'ACP'] },
    { name: 'Phoenix', state: 'AZ', population: '1.6M', programs: ['Lifeline', 'ACP'] },
    { name: 'Philadelphia', state: 'PA', population: '1.6M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Antonio', state: 'TX', population: '1.5M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Diego', state: 'CA', population: '1.4M', programs: ['Lifeline', 'ACP'] },
    { name: 'Dallas', state: 'TX', population: '1.3M', programs: ['Lifeline', 'ACP'] },
    { name: 'San Jose', state: 'CA', population: '1M', programs: ['Lifeline', 'ACP'] },
    { name: 'Austin', state: 'TX', population: '978K', programs: ['Lifeline', 'ACP'] },
    { name: 'Jacksonville', state: 'FL', population: '949K', programs: ['Lifeline', 'ACP'] }
  ]
};

const cities = programCities[program] || programCities.both;
const programNames = {
  lifeline: 'Lifeline Program',
  acp: 'ACP Program', 
  both: 'Government Phone Programs'
};

// Filter out current city if provided
const filteredCities = currentCity ? 
  cities.filter(city => city.name.toLowerCase() !== currentCity.toLowerCase()) : 
  cities;
---

<section class="py-12 bg-white">
  <div class="container mx-auto px-4">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-gray-900 text-3xl font-bold text-center mb-8 ">Cities with {programNames[program]}</h2>
      <p class="text-gray-900 text-center mb-8 ">
        Check your eligibility for {programNames[program].toLowerCase()} in major cities across the country.
      </p>
      
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {filteredCities.slice(0, 12).map((city) => (
          <a 
            href={`/${city.state.toLowerCase()}/${city.name.toLowerCase().replace(/\s+/g, '-')}/`}
            class="block p-4 bg-gray-50 rounded-lg hover:bg-[var(--color-primary-light)] hover:shadow-md transition-all border border-gray-200 hover:border-[var(--color-primary)] text-center"
          >
            <div class="font-semibold mb-1">{city.name}</div>
            <div class="text-sm mb-1">{city.state}</div>
            <div class="text-xs mb-2 text-gray-900">{city.population}</div>
            <div class="text-xs text-[var(--color-primary)] font-medium">
              {city.programs.join(' + ')}
            </div>
          </a>
        ))}
      </div>
      
      <div class="text-center mt-8">
        <a 
          href="/"
          class="inline-flex items-center px-6 py-3 bg-[var(--color-primary)] text-white font-semibold rounded-lg hover:bg-[var(--color-secondary)] transition-colors"
        >
          {browseCitiesText}
          <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </a>
      </div>
    </div>
  </div>
</section> 